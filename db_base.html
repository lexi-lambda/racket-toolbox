<!DOCTYPE html>
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>6.1&nbsp;Extended DB API</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Toolbox:<span class="mywbr"> &nbsp;</span> Miscellaneous Utilities</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="syntax.html" class="tocviewlink" data-pltdoc="x">Syntax</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="data.html" class="tocviewlink" data-pltdoc="x">Data Structures</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="logging.html" class="tocviewlink" data-pltdoc="x">Logging</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="format.html" class="tocviewlink" data-pltdoc="x">Formatting</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="gregor.html" class="tocviewlink" data-pltdoc="x">Gregor</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="db.html" class="tocviewselflink" data-pltdoc="x">Database</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="draw.html" class="tocviewlink" data-pltdoc="x">Drawing</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="web.html" class="tocviewlink" data-pltdoc="x">Web</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>6&nbsp;</td><td><a href="db.html" class="tocviewlink" data-pltdoc="x">Database</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">6.1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Extended DB API</a></td></tr><tr><td align="right">6.2&nbsp;</td><td><a href="db_sql.html" class="tocviewlink" data-pltdoc="x">Formatting SQL</a></td></tr><tr><td align="right">6.3&nbsp;</td><td><a href="db_define.html" class="tocviewlink" data-pltdoc="x">Defining SQL accessors</a></td></tr><tr><td align="right">6.4&nbsp;</td><td><a href="db_sqlite3.html" class="tocviewlink" data-pltdoc="x">SQLite</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>db</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._get-db%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">get-<wbr></wbr>db</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._in-transaction~3f%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">in-<wbr></wbr>transaction?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">call-<wbr></wbr>with-<wbr></wbr>transaction</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">call-<wbr></wbr>with-<wbr></wbr>transaction/<span class="mywbr"> &nbsp;</span>retry</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-max-transaction-retries%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>max-<wbr></wbr>transaction-<wbr></wbr>retries</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-transaction-retry-delay%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>transaction-<wbr></wbr>retry-<wbr></wbr>delay</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-exec%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query-<wbr></wbr>exec</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-rows%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query-<wbr></wbr>rows</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-list%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query-<wbr></wbr>list</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-row%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query-<wbr></wbr>row</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-maybe-row%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query-<wbr></wbr>maybe-<wbr></wbr>row</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-value%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query-<wbr></wbr>value</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-maybe-value%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query-<wbr></wbr>maybe-<wbr></wbr>value</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>log-<wbr></wbr>db-<wbr></wbr>queries?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>explain-<wbr></wbr>db-<wbr></wbr>queries?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>analyze-<wbr></wbr>db-<wbr></wbr>queries?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-changes%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query-<wbr></wbr>changes</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._map-sql-nullable%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">map-<wbr></wbr>sql-<wbr></wbr>nullable</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._lifted-statement%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">lifted-<wbr></wbr>statement</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._toolbox~3adb-logger%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">toolbox:<span class="mywbr"> &nbsp;</span>db-<wbr></wbr>logger</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._exn~3afail~3asql~3abusy~3f%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>sql:<span class="mywbr"> &nbsp;</span>busy?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._exn~3afail~3asql~3aconstraint~3f%29%29" class="tocsublink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>sql:<span class="mywbr"> &nbsp;</span>constraint?</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="db.html" title="backward to &quot;6 Database&quot;" data-pltdoc="x" rel="prev">&larr; prev</a>&nbsp;&nbsp;<a href="db.html" title="up to &quot;6 Database&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="db_sql.html" title="forward to &quot;6.2 Formatting SQL&quot;" data-pltdoc="x" rel="next">next &rarr;</a></span>&nbsp;</div><section class="SsectionLevel3" id="section 6.1"><h3 class="heading">6.1<span class="stt">&nbsp;</span><a name="(part._db~3abase)"></a><a name="(mod-path._toolbox/db/base)"></a>Extended DB API<span class="button-group"><a href="#(part._db~3abase)" class="heading-anchor" title="Link to here">🔗</a><span style="visibility: hidden"> </span></span></h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">toolbox/db/base</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/toolbox-db-lib" title="Install this package using `raco pkg install toolbox-db-lib`"><span class="stt">toolbox-db-lib</span></a></span></td></tr></table></p><p>The <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">toolbox/db/base</span></a> module improves and extends <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>. In addition to the bindings documented in this section, it re-exports all bindings from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a> (except those that have the same name as one of the bindings documented in this section).</p><p>The interface provided by <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">toolbox/db/base</span></a> is <span class="emph">mostly</span> drop-in compatible with that of <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, with two major exceptions:</p><ul><li><p>Most functions have been changed to no longer require an explicit database connection argument. Instead, the value of the <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span> parameter is used.</p></li><li><p>Nested uses of <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction</a></span> do not create <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528tech._nested._transaction%2529" class="techoutside Sq" data-pltdoc="x"><span class="techinside">nested transactions</span></a> by default. The <span class="RktPn">#:nested</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">allow</span> option must be supplied if true nested transactions are desired.</p></li></ul><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._current-db))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-db</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-db</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">db</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that determines the <a name="(tech._current._database._connection)"></a><span style="font-style: italic">current database connection</span>, which many functions use implicitly if a connection is not explicitly provided.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._get-db))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._get-db%29%29" class="RktValDef RktValLink" data-pltdoc="x">get-db</a></span></span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktVar">who</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">who</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">get-db</span></td></tr></table></blockquote></div><div class="SIntrapara">Obtains the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a>. If <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span> is <span class="RktVal">#f</span>, an <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%7E3acontract%2529%2529" class="RktValLink Sq" data-pltdoc="x">exn:fail:contract</a></span> exception is raised (with <span class="RktVar">who</span> inserted at the start of the error message).</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._in-transaction~3f))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._in-transaction~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">in-transaction?</a></span></span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._in-transaction%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">in-transaction?</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._call-with-transaction))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="RktValDef RktValLink" data-pltdoc="x">call-with-transaction</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">thunk</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:isolation</span><span class="hspace">&nbsp;</span><span class="RktVar">isolation-level</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:option</span><span class="hspace">&nbsp;</span><span class="RktVar">option</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:nested</span><span class="hspace">&nbsp;</span><span class="RktVar">nested-mode</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529" class="RktStxLink Sq" data-pltdoc="x">any</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">thunk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529" class="RktStxLink Sq" data-pltdoc="x">any</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">isolation-level</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">serializable</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">repeatable-read</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">read-committed</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">read-uncommitted</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">option</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">nested-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">allow</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">omit</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">fail</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">omit</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._call-with-transaction%2529%2529" class="RktValLink Sq" data-pltdoc="x">call-with-transaction</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default, and behavior when already inside a transaction differs depending on <span class="RktVar">nested-mode</span>:</div></p><ul><li><p>If <span class="RktVar">nested-mode</span> is <span class="RktVal">'</span><span class="RktVal">omit</span> (the default), <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction</a></span> has no effect when already inside a transaction: <span class="RktVar">thunk</span> is invoked directly, without starting a <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528tech._nested._transaction%2529" class="techoutside Sq" data-pltdoc="x"><span class="techinside">nested transaction</span></a>.</p></li><li><p>If <span class="RktVar">nested-mode</span> is <span class="RktVal">'</span><span class="RktVal">allow</span>, <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction</a></span> applies <span class="RktVar">thunk</span> within a <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528tech._nested._transaction%2529" class="techoutside Sq" data-pltdoc="x"><span class="techinside">nested transaction</span></a>. (This is the behavior of <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._call-with-transaction%2529%2529" class="RktValLink Sq" data-pltdoc="x">call-with-transaction</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>.)</p></li><li><p>If <span class="RktVar">nested-mode</span> is <span class="RktVal">'</span><span class="RktVal">fail</span>, <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction</a></span> raises an <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%7E3acontract%2529%2529" class="RktValLink Sq" data-pltdoc="x">exn:fail:contract</a></span> exception if already inside a transaction.</p></li></ul><p>The default value of <span class="RktVal">'</span><span class="RktVal">omit</span> makes <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction</a></span> ensure that <span class="RktVar">thunk</span> is executed in the context of <span class="emph">some</span> transaction, but it does not allow the effects of <span class="RktVar">thunk</span> to be selectively rolled back. In practice, partial rollbacks are rarely useful, and creating savepoints to permit them can have significant performance overhead, so this is usually the right choice.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._call-with-transaction/retry))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValDef RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">thunk</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:isolation</span><span class="hspace">&nbsp;</span><span class="RktVar">isolation-level</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:option</span><span class="hspace">&nbsp;</span><span class="RktVar">option</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:nested</span><span class="hspace">&nbsp;</span><span class="RktVar">nested-mode</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:max-retries</span><span class="hspace">&nbsp;</span><span class="RktVar">max-retries</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:retry-delay</span><span class="hspace">&nbsp;</span><span class="RktVar">retry-delay-secs</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529" class="RktStxLink Sq" data-pltdoc="x">any</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">thunk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529" class="RktStxLink Sq" data-pltdoc="x">any</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">isolation-level</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">serializable</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">repeatable-read</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">read-committed</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">read-uncommitted</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">option</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">nested-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">allow</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">omit</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">fail</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">omit</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">max-retries</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="RktPn">)</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-max-transaction-retries%29%29" class="RktValLink" data-pltdoc="x">current-max-transaction-retries</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">retry-delay-secs</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._%7E3e%7E3d%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">&gt;=/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-transaction-retry-delay%29%29" class="RktValLink" data-pltdoc="x">current-transaction-retry-delay</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction</a></span>, except that <span class="RktVar">thunk</span> may be retried if it raises an <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._exn~3afail~3asql~3abusy~3f%29%29" class="RktValLink" data-pltdoc="x">exn:fail:sql:busy?</a></span> exception. Retrying is not possible if <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span> is called from within another transaction, so if a transaction is already started, <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span> behaves identically to <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction</a></span>.</div></p><p>Assuming retrying is possible, <span class="RktVar">thunk</span> may be executed up to <span class="RktVar">max-retries</span> times before giving up. Before each retry attempt, <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span> sleeps for <span class="RktVar">retry-delay-secs</span> seconds.</p><p>When <span class="RktVar">db</span> is a SQLite connection and <span class="RktVar">option</span> is <span class="RktVal">#f</span> or <span class="RktVal">'</span><span class="RktVal">deferred</span>, retry attempts will automatically use <span class="RktVal">'</span><span class="RktVal">immediate</span> for <span class="RktVar">option</span>, instead. This is usually enough to ensure that <span class="RktVar">thunk</span> itself is only executed at most twice, though the retry limit may still be reached if <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span> is unable to successfully acquire a write transaction.</p><p>Note that the retry mechanism of <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span> is used <span class="emph">in addition to</span> the retry mechanism used for all SQLite operations, which is controlled separately via the <span class="RktPn">#:busy-retry-limit</span> and <span class="RktPn">#:busy-retry-delay</span> arguments to <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fmain..rkt%2529._sqlite3-connect%2529%2529" class="RktValLink Sq" data-pltdoc="x">sqlite3-connect</a></span>. For multi-statement transactions, the retry mechanism of <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span> is often substantially more useful, as a <span class="stt">SQLITE_BUSY</span> failure may indicate that the entire transaction must be restarted, in which case retrying the last statement will never succeed and serves no purpose. However, the intrinsic retry mechanism can be more useful in other situations, especially when the <span class="RktPn">#:use-place</span> argument to <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fmain..rkt%2529._sqlite3-connect%2529%2529" class="RktValLink Sq" data-pltdoc="x">sqlite3-connect</a></span> is <span class="RktVal">'</span><span class="RktVal">os-thread</span>, as it can use <a href="https://www.sqlite.org/c3ref/busy_handler.html">SQLite&#8217;s built-in busy handler</a>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._current-max-transaction-retries))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-max-transaction-retries%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-max-transaction-retries</a></span></span><span class="RktPn"></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-max-transaction-retries%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-max-transaction-retries</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">max-retries</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">max-retries</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">10</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that controls the number of times <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span> will attempt to retry a transaction that fails with a <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._exn~3afail~3asql~3abusy~3f%29%29" class="RktValLink" data-pltdoc="x">exn:fail:sql:busy?</a></span> exception.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._current-transaction-retry-delay))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-transaction-retry-delay%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-transaction-retry-delay</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._%7E3e%7E3d%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">&gt;=/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-transaction-retry-delay%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-transaction-retry-delay</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">retry-delay-secs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">retry-delay-secs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._%7E3e%7E3d%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">&gt;=/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">0.1</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that controls the number of seconds <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._call-with-transaction%2Fretry%29%29" class="RktValLink" data-pltdoc="x">call-with-transaction/retry</a></span> will wait between attempts to retry a transaction that fails with a <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._exn~3afail~3asql~3abusy~3f%29%29" class="RktValLink" data-pltdoc="x">exn:fail:sql:busy?</a></span> exception.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValDef RktValLink" data-pltdoc="x">query</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stmt</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._simple-result%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">simple-result?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._rows-result%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">rows-result?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._prepared-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">prepared-statement?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-log-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query%2529%2529" class="RktValLink Sq" data-pltdoc="x">query</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default and supports automatic query logging and instrumentation. If enabled, all log messages are written to <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._toolbox~3adb-logger%29%29" class="RktValLink" data-pltdoc="x">toolbox:db-logger</a></span> on topic <span class="RktVal">'</span><span class="RktVal">toolbox:db:query</span> at level <span class="RktVal">'</span><span class="RktVal">info</span>.</div></p><p>If <span class="RktVar">log?</span> is not <span class="RktVal">#f</span>, the SQL text of <span class="RktVar">stmt</span> is logged before the query is executed, and the query&#8217;s (wall clock) execution time is logged after the execution completes.</p><p>If <span class="RktVar">explain?</span> is not <span class="RktVal">#f</span>, a textual representation of the database system&#8217;s query plan is logged before the query is executed. Currently, this option is only supported with SQLite; an <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%7E3aunsupported%2529%2529" class="RktValLink Sq" data-pltdoc="x">exn:fail:unsupported</a></span> exception will be raised with other database systems.</p><p>If <span class="RktVar">analyze?</span> is not <span class="RktVal">#f</span>, the query plan is logged in the same way as for <span class="RktVar">explain?</span>, but the plan is logged <span class="emph">after</span> executing the query, and it is annotated with performance information collected during the query&#8217;s execution. Like <span class="RktVar">explain?</span>, this option is currently only supported with SQLite, but <span class="RktVar">analyze?</span> additionally requires that SQLite was compiled with the <span class="stt">SQLITE_ENABLE_STMT_SCANSTATUS</span> compile-time option. The <span class="RktSym"><a href="db_sqlite3.html#%28def._%28%28lib._toolbox%2Fdb%2Fsqlite3..rkt%29._sqlite3-stmt-scanstatus-enabled~3f%29%29" class="RktValLink" data-pltdoc="x">sqlite3-stmt-scanstatus-enabled?</a></span> function can be used to check whether this is the case.</p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fmain..rkt%2529._sqlite3-connect%2529%2529" class="RktValLink Sq" data-pltdoc="x">sqlite3-connect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:database</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">memory</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">can-analyze?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="db_sqlite3.html#%28def._%28%28lib._toolbox%2Fdb%2Fsqlite3..rkt%29._sqlite3-stmt-scanstatus-enabled~3f%29%29" class="RktValLink" data-pltdoc="x">sqlite3-stmt-scanstatus-enabled?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktSym">can-analyze?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktSym">can-analyze?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._string-join%2529%2529" class="RktValLink Sq" data-pltdoc="x">string-join</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">"WITH RECURSIVE"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">fib(i,a,b) AS"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">(SELECT 1, 0, 1"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">UNION ALL"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">SELECT i+1, b, a+b FROM fib"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">WHERE i &lt;= 10)"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"SELECT b FROM fib ORDER BY i"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">"\n"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">[2025-09-14 16:21:52] [toolbox:db:query/INFO] </span></p></td></tr><tr><td><p><span class="RktOut">WITH RECURSIVE</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">fib(i,a,b) AS</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">(SELECT 1, 0, 1</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">UNION ALL</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">SELECT i+1, b, a+b FROM fib</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">WHERE i &lt;= 10)</span></p></td></tr><tr><td><p><span class="RktOut">SELECT b FROM fib ORDER BY i</span></p></td></tr><tr><td><p><span class="RktOut">[2025-09-14 16:21:52] [toolbox:db:query/INFO] 0.2 ms</span></p></td></tr><tr><td><p><span class="RktOut">[2025-09-14 16:21:52] [toolbox:db:query/INFO] QUERY PLAN [cycles=255,578]</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9588;CO-ROUTINE fib</span></p></td></tr><tr><td><p><span class="RktOut">&#9474; &#9500;&#9588;SETUP</span></p></td></tr><tr><td><p><span class="RktOut">&#9474; &#9474; &#9584;&#9588;SCAN CONSTANT ROW</span></p></td></tr><tr><td><p><span class="RktOut">&#9474; &#9584;&#9588;RECURSIVE STEP</span></p></td></tr><tr><td><p><span class="RktOut">&#9474; </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">&#9584;&#9588;SCAN fib </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">3.6% [est=983,040.0 actual=1.0 loops=11 rows=11 cycles=9,270]</span></p></td></tr><tr><td><p><span class="RktOut">&#9500;&#9588;SCAN fib</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">[est=122,880.0 actual=11.0 loops=1 rows=11]</span></p></td></tr><tr><td><p><span class="RktOut">&#9584;&#9588;USE TEMP B-TREE FOR ORDER BY </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">5.7% [est=1.0 actual=11.0 loops=1 rows=11 cycles=14,549]</span></p></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">(rows-result</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">'(((name . "b") (decltype . #f)))</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">'(#(1) #(1) #(2) #(3) #(5) #(8) #(13) #(21) #(34) #(55) #(89)))</span></p></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query-exec))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-exec%29%29" class="RktValDef RktValLink" data-pltdoc="x">query-exec</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stmt</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._prepared-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">prepared-statement?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-log-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query-exec%2529%2529" class="RktValLink Sq" data-pltdoc="x">query-exec</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default and supports automatic query logging and instrumentation like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span>. See the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for information about the behavior of <span class="RktVar">log?</span>, <span class="RktVar">explain?</span>, and <span class="RktVar">analyze?</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query-rows))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-rows%29%29" class="RktValDef RktValLink" data-pltdoc="x">query-rows</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stmt</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:group</span><span class="hspace">&nbsp;</span><span class="RktVar">groupings</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:group-mode</span><span class="hspace">&nbsp;</span><span class="RktVar">group-mode</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">vector?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._prepared-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">prepared-statement?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">groupings</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=let.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._let%252A%2529%2529" class="RktStxLink Sq" data-pltdoc="x">let*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">field/c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">grouping/c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">field/c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fvector..rkt%2529._vectorof%2529%2529" class="RktValLink Sq" data-pltdoc="x">vectorof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">field/c</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">grouping/c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">grouping/c</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">group-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">preserve-null</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">list</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-log-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query-rows%2529%2529" class="RktValLink Sq" data-pltdoc="x">query-rows</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default and supports automatic query logging and instrumentation like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span>. See the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for information about the behavior of <span class="RktVar">log?</span>, <span class="RktVar">explain?</span>, and <span class="RktVar">analyze?</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query-list))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-list%29%29" class="RktValDef RktValLink" data-pltdoc="x">query-list</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stmt</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">list?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._prepared-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">prepared-statement?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-log-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query-list%2529%2529" class="RktValLink Sq" data-pltdoc="x">query-list</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default and supports automatic query logging and instrumentation like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span>. See the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for information about the behavior of <span class="RktVar">log?</span>, <span class="RktVar">explain?</span>, and <span class="RktVar">analyze?</span>.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query-row))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-row%29%29" class="RktValDef RktValLink" data-pltdoc="x">query-row</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stmt</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">vector?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._prepared-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">prepared-statement?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-log-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query-row%2529%2529" class="RktValLink Sq" data-pltdoc="x">query-row</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default and supports automatic query logging and instrumentation like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span>. See the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for information about the behavior of <span class="RktVar">log?</span>, <span class="RktVar">explain?</span>, and <span class="RktVar">analyze?</span>.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query-maybe-row))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-maybe-row%29%29" class="RktValDef RktValLink" data-pltdoc="x">query-maybe-row</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stmt</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">vector?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._prepared-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">prepared-statement?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-log-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query-maybe-row%2529%2529" class="RktValLink Sq" data-pltdoc="x">query-maybe-row</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default and supports automatic query logging and instrumentation like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span>. See the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for information about the behavior of <span class="RktVar">log?</span>, <span class="RktVar">explain?</span>, and <span class="RktVar">analyze?</span>.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query-value))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-value%29%29" class="RktValDef RktValLink" data-pltdoc="x">query-value</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stmt</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._prepared-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">prepared-statement?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-log-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query-value%2529%2529" class="RktValLink Sq" data-pltdoc="x">query-value</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default and supports automatic query logging and instrumentation like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span>. See the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for information about the behavior of <span class="RktVar">log?</span>, <span class="RktVar">explain?</span>, and <span class="RktVar">analyze?</span>.
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query-maybe-value))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-maybe-value%29%29" class="RktValDef RktValLink" data-pltdoc="x">query-maybe-value</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stmt</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span><span class="RktOpt">[</span></td><td valign="top"><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:log?</span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:explain?</span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:analyze?</span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktOpt">]</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._prepared-statement%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">prepared-statement?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-log-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query-maybe-value%2529%2529" class="RktValLink Sq" data-pltdoc="x">query-maybe-value</a></span> from <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528mod-path._db%252Fbase%2529" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db/base</span></a>, but uses the <a href="#%28tech._current._database._connection%29" class="techoutside" data-pltdoc="x"><span class="techinside">current database connection</span></a> by default and supports automatic query logging and instrumentation like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span>. See the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for information about the behavior of <span class="RktVar">log?</span>, <span class="RktVar">explain?</span>, and <span class="RktVar">analyze?</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._current-log-db-queries~3f))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-log-db-queries?</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-log-db-queries~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-log-db-queries?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">log?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">log?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that controls whether functions like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> should log each query&#8217;s SQL text; see the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for details.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._current-explain-db-queries~3f))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-explain-db-queries~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-explain-db-queries?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">explain?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">explain?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that controls whether functions like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> should log each query&#8217;s query plan before execution; see the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for details.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._current-analyze-db-queries~3f))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-analyze-db-queries~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">current-analyze-db-queries?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">analyze?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">analyze?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#f</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">A parameter that controls whether functions like <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> should log each query&#8217;s profiled query plan after execution; see the documentation for <span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query%29%29" class="RktValLink" data-pltdoc="x">query</a></span> for details.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._query-changes))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._query-changes%29%29" class="RktValDef RktValLink" data-pltdoc="x">query-changes</a></span></span><span class="hspace">&nbsp;</span><span class="RktOpt">[</span><span class="RktPn">#:db</span><span class="hspace">&nbsp;</span><span class="RktVar">db</span><span class="RktOpt">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">db</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">connection?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._current-db%29%29" class="RktValLink" data-pltdoc="x">current-db</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the number of database rows that were changed, inserted, or deleted by the most recently completed <span class="stt">INSERT</span>, <span class="stt">DELETE</span>, or <span class="stt">UPDATE</span> statement. Currently only supported with SQLite; an <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%7E3aunsupported%2529%2529" class="RktValLink Sq" data-pltdoc="x">exn:fail:unsupported</a></span> exception will be raised with other database systems.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._map-sql-nullable))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._map-sql-nullable%29%29" class="RktValDef RktValLink" data-pltdoc="x">map-sql-nullable</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">proc</span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">If <span class="RktVar">v</span> is <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=sql-types.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._sql-null%2529%2529" class="RktValLink Sq" data-pltdoc="x">sql-null</a></span>, returns <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=sql-types.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._sql-null%2529%2529" class="RktValLink Sq" data-pltdoc="x">sql-null</a></span>, otherwise returns <span class="RktPn">(</span><span class="RktVar">proc</span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span>.</div></p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._map-sql-nullable%29%29" class="RktValLink" data-pltdoc="x">map-sql-nullable</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._add1%2529%2529" class="RktValLink Sq" data-pltdoc="x">add1</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">2</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._map-sql-nullable%29%29" class="RktValLink" data-pltdoc="x">map-sql-nullable</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._add1%2529%2529" class="RktValLink Sq" data-pltdoc="x">add1</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=sql-types.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._sql-null%2529%2529" class="RktValLink Sq" data-pltdoc="x">sql-null</a></span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#&lt;sql-null&gt;</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._toolbox/db/base..rkt)._lifted-statement))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28form._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._lifted-statement%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">lifted-statement</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">expr</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._dbsystem%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">dbsystem?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Equivalent to <span class="RktPn">(</span><span class="RktSym"><a href="syntax.html#%28form._%28%28lib._toolbox%2Flift..rkt%29._~23~25lift%29%29" class="RktStxLink" data-pltdoc="x">#%lift</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement</a></span><span class="stt"> </span><span class="RktVar">expr</span><span class="RktPn">)</span><span class="RktPn">)</span>. That is, <span class="RktSym"><a href="#%28form._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._lifted-statement%29%29" class="RktStxLink" data-pltdoc="x">lifted-statement</a></span> is like <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._virtual-statement%2529%2529" class="RktValLink Sq" data-pltdoc="x">virtual-statement</a></span>, except that it is implicitly lifted to the top of the enclosing module (so <span class="RktVar">expr</span> may not reference local variables). This allows a <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528tech._virtual._statement%2529" class="techoutside Sq" data-pltdoc="x"><span class="techinside">virtual statement</span></a> to be declared inline, where it is used.</div></p><p>Also see <span class="RktSym"><a href="db_sql.html#%28form._%28%28lib._toolbox%2Fdb%2Fsql..rkt%29._~7estmt%29%29" class="RktStxLink" data-pltdoc="x">~stmt</a></span>, which combines <span class="RktSym"><a href="#%28form._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._lifted-statement%29%29" class="RktStxLink" data-pltdoc="x">lifted-statement</a></span> and <span class="RktSym"><a href="db_sql.html#%28def._%28%28lib._toolbox%2Fdb%2Fsql..rkt%29._~7esql%29%29" class="RktValLink" data-pltdoc="x">~sql</a></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._toolbox/db/base..rkt)._toolbox~3adb-logger))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._toolbox~3adb-logger%29%29" class="RktValDef RktValLink" data-pltdoc="x">toolbox:db-logger</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=logging.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._logger%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">logger?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A <a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=logging.html%23%2528tech._logger%2529" class="techoutside Sq" data-pltdoc="x"><span class="techinside">logger</span></a> used by various functions in <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">toolbox/db/base</span></a>. Its parent logger is <span class="RktSym"><a href="logging.html#%28def._%28%28lib._toolbox%2Flogger..rkt%29._toolbox-logger%29%29" class="RktValLink" data-pltdoc="x">toolbox-logger</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._exn~3afail~3asql~3abusy~3f))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._exn~3afail~3asql~3abusy~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">exn:fail:sql:busy?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is an <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._exn%7E3afail%7E3asql%2529%2529" class="RktValLink Sq" data-pltdoc="x">exn:fail:sql</a></span> exception and <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._exn%7E3afail%7E3asql-sqlstate%2529%2529" class="RktValLink Sq" data-pltdoc="x">exn:fail:sql-sqlstate</a></span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span> is <span class="RktVal">'</span><span class="RktVal">busy</span>. Otherwise, returns <span class="RktVal">#f</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._toolbox/db/base..rkt)._exn~3afail~3asql~3aconstraint~3f))"></a><span title="Provided from: toolbox/db/base | Package: toolbox-db-lib"><span class="RktSym"><a href="#%28def._%28%28lib._toolbox%2Fdb%2Fbase..rkt%29._exn~3afail~3asql~3aconstraint~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">exn:fail:sql:constraint?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is an <span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._exn%7E3afail%7E3asql%2529%2529" class="RktValLink Sq" data-pltdoc="x">exn:fail:sql</a></span> exception and <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._exn%7E3afail%7E3asql-sqlstate%2529%2529" class="RktValLink Sq" data-pltdoc="x">exn:fail:sql-sqlstate</a></span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span> is <span class="RktVal">'</span><span class="RktVal">constraint</span>. Otherwise, returns <span class="RktVal">#f</span>.</div></p></section><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="db.html" title="backward to &quot;6 Database&quot;" data-pltdoc="x" rel="prev">&larr; prev</a>&nbsp;&nbsp;<a href="db.html" title="up to &quot;6 Database&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="db_sql.html" title="forward to &quot;6.2 Formatting SQL&quot;" data-pltdoc="x" rel="next">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>